(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{325:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(327);var a={create:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.created||(this.created=!0,this.opened=!1,this.closing=!1,this.popupElement=document.createElement("div"),this.popupElement.classList.add("popup-wrapper"),this.popupElement.insertAdjacentHTML("afterbegin",'\n            <div class="popup-window">\n                <p>'.concat(e,"</p>\n            </div>")),document.getElementById("app").appendChild(this.popupElement),this.popupElement.addEventListener("click",(function(e){e.target===t.popupElement&&t.close()})),setTimeout((function(){t.open(),n>0&&setTimeout((function(){return t.close()}),n)}),0))},open:function(){this.closing||this.opened||(this.opened=!0,this.popupElement.classList.add("open"))},close:function(){var e=this;this.opened&&(this.closing=!0,this.opened=!1,this.popupElement.classList.remove("open"),this.popupElement.classList.add("closing"),setTimeout((function(){e.popupElement.classList.remove("closing"),e.closing=!1,e.created=!1,e.popupElement.remove()}),300))}}},327:function(e,t,n){},339:function(e,t,n){},340:function(e,t,n){},341:function(e,t,n){},343:function(e,t,n){"use strict";n.r(t),n.d(t,"tablePage",(function(){return y}));var a=n(49),r=n(330),c=n.n(r);n(132);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t,n,a,r,c,o){try{var i=e[c](o),d=i.value}catch(e){return void n(e)}i.done?t(d):Promise.resolve(d).then(a,r)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var c=e.apply(t,n);function o(e){s(c,a,r,o,i,"next",e)}function i(e){s(c,a,r,o,i,"throw",e)}o(void 0)}))}}var p={docs:[],initialState:[{baseDoc:{details:"Реквизиты документа-основания номер один",fileUrl:"./res/baseDocs/11.pdf"},recipient:"Витальев Виталий Витальевич",periodicity:"week",reportDoc:{details:"Реквизиты отчетного документа номер один",fileUrl:"./res/reportDocs/12.pdf"},addressee:"Сергеев Сергей Сергеевич",contact:{name:"Иванов Иван Иванович",phone:"+7-654-32-10",email:"Ivanov.I.I@site.com"},reportDate:1599119223930,status:!1,executor:"Скворцова Вера Павловна"},{baseDoc:{details:"Реквизиты документа-основания номер два",fileUrl:"./res/baseDocs/21.pdf"},recipient:"Антонов Антон Антонович",periodicity:"month",reportDoc:{details:"Реквизиты отчетного документа номер два",fileUrl:"./res/reportDocs/22.pdf"},addressee:"Медведева Дарья Васильевна",contact:{name:"Васильев Василий Васильевич",phone:"+7-123-45-67",email:"Vasiliev.V.V@site.com"},reportDate:1600128e6,status:!1,executor:null},{baseDoc:{details:"Реквизиты документа-основания номер три",fileUrl:"./res/baseDocs/31.pdf"},recipient:"Волкова Татьяна Борисовна",periodicity:"quarter",reportDoc:{details:"Реквизиты отчетного документа номер три",fileUrl:"./res/reportDocs/32.pdf"},addressee:"Кошкина Галина Сергеевна",contact:{name:"Федоров Федор Федорович",phone:"+7-800-55-35-35",email:"Fedorov.F.F@site.com"},reportDate:15996096e5,status:!0,executor:"Зайцева Тамара Артемовна"}],fetchDocs:function(){var e=this;return l(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.a.database().ref("/docs/").once("value").then((function(t){var n=t.val();return e.docs=n?Object.keys(n).map((function(e){return i(i({},n[e]),{},{id:e})})):[],Promise.resolve(e.docs)}));case 3:t.next=10;break;case 5:return t.prev=5,t.t0=t.catch(0),t.next=9,Promise.reject(t.t0);case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}}),t,null,[[0,5]])})))()},updateDoc:function(e,t){var n=this;return l(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,c.a.database().ref("/docs/").child(e).update(t);case 3:r=n.getDocIndexById(e),n.docs[r]=i(i({},t),{},{id:e}),document.dispatchEvent(new CustomEvent("docsUpdated",{detail:{type:"update",message:"Изменения сохранены"}})),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),document.dispatchEvent(new CustomEvent("docsUpdated",{detail:{type:"error",message:"Произошла ошибка"}}));case 11:case"end":return a.stop()}}),a,null,[[0,8]])})))()},createDoc:function(e){var t=this;return l(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,c.a.database().ref("/docs/").push(e).getKey();case 3:(a=n.sent)&&(t.docs.push(i(i({},e),{},{id:a})),document.dispatchEvent(new CustomEvent("docsUpdated",{detail:{type:"create",message:"Документ создан"}}))),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),document.dispatchEvent(new CustomEvent("docsUpdated",{detail:{type:"error",message:"Произошла ошибка"}}));case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()},deleteDoc:function(e){var t=this;return l(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,c.a.database().ref("/docs/").child(e.id).remove();case 3:t.docs.splice(t.getDocIndexById(e.id),1),document.dispatchEvent(new CustomEvent("docsUpdated",{detail:{type:"delete",message:"Документ удален"}})),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),document.dispatchEvent(new CustomEvent("docsUpdated",{detail:{type:"error",message:"Произошла ошибка"}}));case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))()},reset:function(){var e=this;return l(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,c.a.database().ref("/docs/").remove();case 3:return t.next=5,c.a.database().ref("/docs/").push(e.initialState[0]);case 5:return t.next=7,c.a.database().ref("/docs/").push(e.initialState[1]);case 7:return t.next=9,c.a.database().ref("/docs/").push(e.initialState[2]);case 9:return e.docs=[],t.next=12,e.fetchDocs();case 12:return document.dispatchEvent(new CustomEvent("docsUpdated",{detail:{type:"reset",message:"Все данные в таблице сброшены к первоначальным"}})),t.next=15,Promise.resolve(e.docs);case 15:return t.abrupt("return",t.sent);case 18:t.prev=18,t.t0=t.catch(0),document.dispatchEvent(new CustomEvent("docsUpdated",{detail:{type:"error",message:"Произошла ошибка"}}));case 21:case"end":return t.stop()}}),t,null,[[0,18]])})))()},getDocIndexById:function(e){return this.docs.findIndex((function(t){return t.id===e}))}},u=n(325),m=function(e,t,n){var a=e.insertCell(t);if(a.insertAdjacentHTML("beforeend","<i>Реквизиты:</i> ".concat(n.details||"Не указаны"," ")),n.fileUrl){a.insertAdjacentHTML("beforeend","\n            <iframe\n                src='".concat(n.fileUrl,"' id='").concat(n.fileUrl,"'\n                frameborder='0' style='border:0;'\n                width='0' height='0'>\n            </iframe>\n        "));var r=document.createElement("button");r.insertAdjacentHTML("afterbegin",'<i class="fas fa-print"></i> Распечатать'),a.append(r),r.addEventListener("click",(function(e){e.preventDefault();var t=document.getElementById(n.fileUrl);if(t&&(t.contentWindow.document&&t.contentWindow||t.contentDocument)){var a=(t.contentWindow.document||t.contentDocument).getElementsByTagName("embed");a&&a.length>0?(t.contentWindow.focus(),t.contentWindow.print()):u.a.create("Документа нет",1500)}else u.a.create("Документа нет",1500)}))}else a.insertAdjacentHTML("beforeend","<i>Документа нет</i>");return a};function f(e,t,n){return function e(t,n,a,r){r!==n.length-1?(t[n[r]]||(t[n[r]]={}),e(t[n[r]],n,a,r+1)):t[n[r]]=a}(e,t.split("."),n,0),e}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=new Date(e),n=t.getDate();n=n<10?"0"+n:n;var a=t.getMonth()+1;return a=a<10?"0"+a:a,t.getFullYear()+"-"+a+"-"+n}n(339);var h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;console.log(e);var t=document.createElement("div");t.classList.add("form-wrapper"),t.setAttribute("id","form-record");var n=document.createElement("form");n.setAttribute("name","form-record"),n.classList.add("form-record"),t.append(n);var a="";e&&e.reportDate&&(a=v(e.reportDate)),n.insertAdjacentHTML("afterbegin","\n        <fieldset>\n            <legend>Документ основание</legend>\n            <div class='form-item'>\n                <label for='id-baseDoc-details'>Реквизиты</label>\n                <input id='id-baseDoc-details' name='baseDoc.details' data-nested=true type='text' placeholder='Реквизиты' value='".concat(e&&e.baseDoc.details||"","'/>\n            </div>\n            <div class='form-item'>\n                <label for='id-baseDoc-fileUrl'>Ссылка на документ</label>\n                <input id='id-baseDoc-fileUrl' name='baseDoc.fileUrl' data-nested=true type='text' placeholder='Ссылка на документ' value='").concat(e&&e.baseDoc.fileUrl||"","'/>\n            </div>\n        </fieldset>\n        \n        <div class='form-item'>\n            <label for='id-recipient'>Получатель отчетного документа</label>\n            <input id='id-recipient' name='recipient' type='text' placeholder='Ф.И.О. получателя' value='").concat(e&&e.recipient||"","'/>\n        </div>\n        <div class='form-item'>\n            <label for='id-periodicity'>Периодичность предоставления</label>\n            <select id='id-periodicity' name='periodicity'>\n                    <option ").concat(e&&!e.periodicity||!e?"selected":""," value=''>Без указания периодичности</option>\n                    <option ").concat(e&&"day"===e.periodicity?"selected":""," value='day'>Ежедневно</option>\n                    <option ").concat(e&&"week"===e.periodicity?"selected":""," value='week'>Еженедельно</option>\n                    <option ").concat(e&&"month"===e.periodicity?"selected":""," value='month'>Ежемесячно</option>\n                    <option ").concat(e&&"quarter"===e.periodicity?"selected":""," value='quarter'>Ежеквартально</option>\n                    <option ").concat(e&&"year"===e.periodicity?"selected":""," value='year'>Ежегодно</option>\n            </select>\n        </div>\n        <fieldset>\n            <legend>Отчетный документ</legend>\n            <div class='form-item'>\n                <label for='id-reportDoc-details'>Реквизиты</label>\n                <input id='id-reportDoc-details' name='reportDoc.details' data-nested='true' type='text' placeholder='Реквизиты' value='").concat(e&&e.reportDoc.details||"","'/>\n            </div>\n            <div class='form-item'>\n                <label for='id-reportDoc-fileUrl'>Ссылка на документ</label>\n                <input id='id-reportDoc-fileUrl' name='reportDoc.fileUrl' data-nested='true' type='text' placeholder='Ссылка на документ' value='").concat(e&&e.reportDoc.fileUrl||"","'/>\n            </div>\n        </fieldset>\n        <div class='form-item'>\n            <label for='id-addressee'>Адресат</label>\n            <input id='id-addressee' name='addressee' type='text' placeholder='Введите адресата' value='").concat(e&&e.addressee||"","'/>\n        </div>\n        <fieldset>\n            <legend>Контактное лицо Учреждения</legend>\n            <div class='form-item'>\n                <label for='id-contact-name'>Ф.И.О.</label>\n                <input id='id-contact-name' name='contact.name' data-nested='true' type='text' placeholder='Ф.И.О. контактного лица' value='").concat(e&&e.contact.name||"","'/>\n            </div>\n            <div class='form-item'>\n                <label for='id-contact-phone'>Телефон</label>\n                <input id='id-contact-phone' name='contact.phone' data-nested='true' type='text' placeholder='Телефон контактного лица' value='").concat(e&&e.contact.phone||"","'/>\n            </div>\n            <div class='form-item'>\n                <label for='id-contact-email'>Почта</label>\n                <input id='id-contact-email' name='contact.email' data-nested='true' type='text' placeholder='Почта контактного лица' value='").concat(e&&e.contact.email||"","'/>\n            </div>\n        </fieldset>\n        <div class='form-item'>\n            <label for='id-reportDate'>Дата предоставления отчета</label>\n            <input id='id-reportDate' name='reportDate' type='date' placeholder='Введите дату' value='").concat(a,"'/>\n        </div>\n        <div class='form-item'>\n            <label for='id-status'>Индикатор исполнения</label>\n            <input id='id-status' name='status' type='checkbox' placeholder='Ссылка на документ' ").concat(e&&e.status?'checked="checked"':"","'/>\n        </div>\n        <div class='form-item'>\n            <label for='id-executor'>Текущий исполнитель</label>\n            <input id='id-executor' name='executor' type='text' placeholder='Текущий исполнитель' value='").concat(e&&e.executor||"","'/>\n        </div> \n        <div class='form-item'>\n        </div> \n    "));var r=document.createElement("button");r.classList.add("accept"),r.append(e?"Сохранить изменения":"Создать"),n.lastElementChild.append(r);var c=document.createElement("button");return c.append("Отмена"),n.lastElementChild.append(c),c.addEventListener("click",(function(e){e.preventDefault(),t.remove()})),r.addEventListener("click",(function(t){t.preventDefault(),r.disabled=!0,c.disabled=!0;for(var n={},a=0;a<document.forms["form-record"].elements.length;a++){var o=document.forms["form-record"].elements[a];o.name&&("checkbox"===o.type?n[o.name]=o.checked:"date"===o.type?n[o.name]=(o.value?new Date(o.value):new Date).getTime():o.dataset.nested?f(n,o.name,o.value):n[o.name]=o.value)}e?p.updateDoc(e.id,n):p.createDoc(n)})),t},b=function(e,t,n){var a=new Date(n.reportDate).toLocaleDateString("ru",{day:"numeric",month:"short",year:"numeric"}),r=(new Date).getTime()-n.reportDate>=0&&!n.status?"alert":n.reportDate-(new Date).getTime()<=2592e5&&n.reportDate-(new Date).getTime()>0&&!n.status?"warning":"",c=n.status?"completed":"notcompleted",o="day"===n.periodicity?"Ежедневно":"week"===n.periodicity?"Еженедельно":"month"===n.periodicity?"Ежемесячно":"quarter"===n.periodicity?"Ежеквартально":"year"===n.periodicity?"Ежегодно":"Периодичность не указана",i=e.insertRow(t);i.setAttribute("id",n.id),i.insertAdjacentHTML("afterbegin","<td>".concat(t,"</td>")),m(i,1,n.baseDoc),i.insertAdjacentHTML("beforeend","\n        <td>".concat(n.recipient||"Не указан","</td>\n        <td>").concat(o,"</td>\n    ")),m(i,4,n.reportDoc),i.insertAdjacentHTML("beforeend","\n        <td>".concat(n.addressee||"Не указано","</td>\n        <td>\n            ").concat(n.contact.name||"Ф.И.О. не указано","\n            <br>тел.: ").concat(n.contact.phone||"не указан","\n            <br>почта: ").concat(n.contact.email||"не указана",'\n        </td>\n        <td class="').concat(r,'">\n            ').concat(a,'\n        </td>\n        <td class= "').concat(c,'">\n            ').concat(n.status?"Выполнено":"Не выполнено","\n        </td>\n        <td>\n            ").concat(n.executor||"Нет исполнителя","\n        </td>\n        <td></td>\n    "));var d=document.createElement("button");d.insertAdjacentHTML("afterbegin",'<i class="far fa-edit"></i>'),i.lastElementChild.append(d),d.addEventListener("click",(function(e){e.preventDefault(),document.getElementById("form-record")||i.parentElement.parentElement.before(h(n))}));var s=document.createElement("button");return s.classList.add("delete"),s.insertAdjacentHTML("afterbegin",'<i class="far fa-trash-alt"></i>'),i.lastElementChild.append(s),s.addEventListener("click",(function(e){e.preventDefault(),s.disabled=!0,d.disabled=!0,p.deleteDoc(n)})),i},g=(n(340),function(){var e=document.createElement("table");e.classList.add("table-documents");var t=document.createElement("p");t.append("Документов нет");var n=function(){e.insertRow(0).insertAdjacentHTML("afterbegin","\n                <td>№</td>\n                <td>Документ-основание</td>\n                <td>Получатель отчетного документа</td>\n                <td>Периодичность предоставления</td>\n                <td>Отчетный документ</td>\n                <td>Адресат</td>\n                <td>Контактное лицо Учреждения</td>\n                <td>Дата предоставления отчета</td>\n                <td>Индикатор исполнения</td>\n                <td>Текущий исполнитель</td>\n                <td></td>\n            ")},a=function(){for(var t=0;t<p.docs.length;t++)b(e,t+1,p.docs[t])};return 0!==p.docs.length&&p.docs?(n(),a()):e.append(t),document.addEventListener("docsUpdated",(function(r){if(document.getElementById("form-record")&&document.getElementById("form-record").remove(),u.a.create(r.detail.message,1500),t&&t.remove(),e.rows.length>0)for(var c=e.rows.length-1;c>=0;c--)e.rows[c].remove();0!==p.docs.length&&p.docs?(n(),a()):e.append(t)})),e}),D=n(130),y=(n(341),{render:function(){var e=document.createElement("div");e.classList.add("app-content"),e.insertAdjacentHTML("afterbegin",'\n        <div class="table-page-header">\n            <h1><i class="fas fa-laptop"></i> Личный кабинет</h1>\n            <p>'.concat(a.c.user.email,'</p>\n        </div>\n        <div class="table-page-menu">\n            <h2> <i class="far fa-file-alt"></i> Список отчетных документов:</h2>  \n        </div>\n        <div class="table-page-content">          \n        </div>\n        '));var t=document.createElement("button");t.append("Выйти"),e.firstElementChild.append(t),t.addEventListener("click",(function(e){e.preventDefault(),a.c.logout()}));var n=document.createElement("button");n.classList.add("accept"),n.insertAdjacentHTML("afterbegin",'<i class="far fa-file"></i> Создать новый документ'),e.children[1].append(n);var r=document.createElement("button");r.classList.add("delete"),r.insertAdjacentHTML("afterbegin",'<i class="fas fa-redo"></i> Сбросить данные к изначальным'),e.children[1].append(r),n.addEventListener("click",(function(t){t.preventDefault(),document.getElementById("form-record")||e.lastElementChild.prepend(h())})),r.addEventListener("click",(function(e){e.preventDefault(),n.disabled=!0,r.disabled=!0,p.reset().then((function(){n.disabled=!1,r.disabled=!1}))}));var c=Object(D.a)();return e.lastElementChild.append(c),p.fetchDocs().then((function(){c.remove(),e.lastElementChild.append(g())})),e}})}}]);